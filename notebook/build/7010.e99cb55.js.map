{"version":3,"file":"7010.e99cb55.js","mappings":"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","sources":["webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@retrolab/notebook-extension/lib/index.js"],"sourcesContent":["// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { DOMUtils } from '@jupyterlab/apputils';\nimport { Text, Time } from '@jupyterlab/coreutils';\nimport { IDocumentManager } from '@jupyterlab/docmanager';\nimport { IMainMenu } from '@jupyterlab/mainmenu';\nimport { NotebookPanel, INotebookTracker } from '@jupyterlab/notebook';\nimport { ISettingRegistry } from '@jupyterlab/settingregistry';\nimport { ITranslator } from '@jupyterlab/translation';\nimport { IRetroShell } from '@retrolab/application';\nimport { Poll } from '@lumino/polling';\nimport { Menu, Widget } from '@lumino/widgets';\n/**\n * The class for kernel status errors.\n */\nconst KERNEL_STATUS_ERROR_CLASS = 'jp-RetroKernelStatus-error';\n/**\n * The class for kernel status warnings.\n */\nconst KERNEL_STATUS_WARN_CLASS = 'jp-RetroKernelStatus-warn';\n/**\n * The class for kernel status infos.\n */\nconst KERNEL_STATUS_INFO_CLASS = 'jp-RetroKernelStatus-info';\n/**\n * The class to fade out the kernel status.\n */\nconst KERNEL_STATUS_FADE_OUT_CLASS = 'jp-RetroKernelStatus-fade';\n/**\n * The class for scrolled outputs\n */\nconst SCROLLED_OUTPUTS_CLASS = 'jp-mod-outputsScrolled';\n/**\n * A plugin for the checkpoint indicator\n */\nconst checkpoints = {\n    id: '@retrolab/notebook-extension:checkpoints',\n    autoStart: true,\n    requires: [IDocumentManager, ITranslator],\n    optional: [IRetroShell],\n    activate: (app, docManager, translator, retroShell) => {\n        const { shell } = app;\n        const trans = translator.load('retrolab');\n        const widget = new Widget();\n        widget.id = DOMUtils.createDomID();\n        widget.addClass('jp-RetroCheckpoint');\n        app.shell.add(widget, 'top', { rank: 100 });\n        const onChange = async () => {\n            const current = shell.currentWidget;\n            if (!current) {\n                return;\n            }\n            const context = docManager.contextForWidget(current);\n            context === null || context === void 0 ? void 0 : context.fileChanged.disconnect(onChange);\n            context === null || context === void 0 ? void 0 : context.fileChanged.connect(onChange);\n            const checkpoints = await (context === null || context === void 0 ? void 0 : context.listCheckpoints());\n            if (!checkpoints) {\n                return;\n            }\n            const checkpoint = checkpoints[checkpoints.length - 1];\n            widget.node.textContent = trans.__('Last Checkpoint: %1', Time.formatHuman(new Date(checkpoint.last_modified)));\n        };\n        if (retroShell) {\n            retroShell.currentChanged.connect(onChange);\n        }\n        new Poll({\n            auto: true,\n            factory: () => onChange(),\n            frequency: {\n                interval: 2000,\n                backoff: false\n            },\n            standby: 'when-hidden'\n        });\n    }\n};\n/**\n * The kernel logo plugin.\n */\nconst kernelLogo = {\n    id: '@retrolab/notebook-extension:kernel-logo',\n    autoStart: true,\n    requires: [IRetroShell],\n    activate: (app, shell) => {\n        const { serviceManager } = app;\n        let widget;\n        const onChange = async () => {\n            var _a, _b, _c, _d, _e;\n            if (widget) {\n                widget.dispose();\n                widget.parent = null;\n            }\n            const current = shell.currentWidget;\n            if (!(current instanceof NotebookPanel)) {\n                return;\n            }\n            await current.sessionContext.ready;\n            current.sessionContext.kernelChanged.disconnect(onChange);\n            current.sessionContext.kernelChanged.connect(onChange);\n            const name = (_c = (_b = (_a = current.sessionContext.session) === null || _a === void 0 ? void 0 : _a.kernel) === null || _b === void 0 ? void 0 : _b.name) !== null && _c !== void 0 ? _c : '';\n            const spec = (_e = (_d = serviceManager.kernelspecs) === null || _d === void 0 ? void 0 : _d.specs) === null || _e === void 0 ? void 0 : _e.kernelspecs[name];\n            if (!spec) {\n                return;\n            }\n            const kernelIconUrl = spec.resources['logo-64x64'];\n            if (!kernelIconUrl) {\n                return;\n            }\n            const node = document.createElement('div');\n            const img = document.createElement('img');\n            img.src = kernelIconUrl;\n            img.title = spec.display_name;\n            node.appendChild(img);\n            widget = new Widget({ node });\n            widget.addClass('jp-RetroKernelLogo');\n            app.shell.add(widget, 'top', { rank: 10010 });\n        };\n        app.started.then(() => {\n            shell.currentChanged.connect(onChange);\n        });\n    }\n};\n/**\n * A plugin to display the kernel status;\n */\nconst kernelStatus = {\n    id: '@retrolab/notebook-extension:kernel-status',\n    autoStart: true,\n    requires: [IRetroShell, ITranslator],\n    activate: (app, shell, translator) => {\n        const trans = translator.load('retrolab');\n        const widget = new Widget();\n        widget.addClass('jp-RetroKernelStatus');\n        app.shell.add(widget, 'menu', { rank: 10010 });\n        const removeClasses = () => {\n            widget.removeClass(KERNEL_STATUS_ERROR_CLASS);\n            widget.removeClass(KERNEL_STATUS_WARN_CLASS);\n            widget.removeClass(KERNEL_STATUS_INFO_CLASS);\n            widget.removeClass(KERNEL_STATUS_FADE_OUT_CLASS);\n        };\n        const onStatusChanged = (sessionContext) => {\n            const status = sessionContext.kernelDisplayStatus;\n            let text = `Kernel ${Text.titleCase(status)}`;\n            removeClasses();\n            switch (status) {\n                case 'busy':\n                case 'idle':\n                    text = '';\n                    widget.addClass(KERNEL_STATUS_FADE_OUT_CLASS);\n                    break;\n                case 'dead':\n                case 'terminating':\n                    widget.addClass(KERNEL_STATUS_ERROR_CLASS);\n                    break;\n                case 'unknown':\n                    widget.addClass(KERNEL_STATUS_WARN_CLASS);\n                    break;\n                default:\n                    widget.addClass(KERNEL_STATUS_INFO_CLASS);\n                    widget.addClass(KERNEL_STATUS_FADE_OUT_CLASS);\n                    break;\n            }\n            widget.node.textContent = trans.__(text);\n        };\n        const onChange = async () => {\n            const current = shell.currentWidget;\n            if (!(current instanceof NotebookPanel)) {\n                return;\n            }\n            const sessionContext = current.sessionContext;\n            sessionContext.statusChanged.connect(onStatusChanged);\n        };\n        shell.currentChanged.connect(onChange);\n    }\n};\n/**\n * A plugin to customize notebook related menu entries\n * TODO: switch to settings define menus when fixed upstream: https://github.com/jupyterlab/jupyterlab/issues/11754\n */\nconst menuPlugin = {\n    id: '@retrolab/notebook-extension:menu-plugin',\n    autoStart: true,\n    requires: [IMainMenu, ITranslator],\n    activate: (app, mainMenu, translator) => {\n        const { commands } = app;\n        const trans = translator.load('retrolab');\n        const cellTypeSubmenu = new Menu({ commands });\n        cellTypeSubmenu.title.label = trans._p('menu', 'Cell Type');\n        [\n            'notebook:change-cell-to-code',\n            'notebook:change-cell-to-markdown',\n            'notebook:change-cell-to-raw'\n        ].forEach(command => {\n            cellTypeSubmenu.addItem({\n                command\n            });\n        });\n        mainMenu.runMenu.addItem({ type: 'separator', rank: 1000 });\n        mainMenu.runMenu.addItem({\n            type: 'submenu',\n            submenu: cellTypeSubmenu,\n            rank: 1010\n        });\n    }\n};\n/**\n * A plugin to add an extra shortcut to execute a cell in place via Cmd-Enter on Mac.\n * TODO: switch to settings define menus when fixed upstream: https://github.com/jupyterlab/jupyterlab/issues/11754\n */\nconst runShortcut = {\n    id: '@retrolab/notebook-extension:run-shortcut',\n    autoStart: true,\n    activate: (app) => {\n        app.commands.addKeyBinding({\n            command: 'notebook:run-cell',\n            keys: ['Accel Enter'],\n            selector: '.jp-Notebook:focus'\n        });\n        app.commands.addKeyBinding({\n            command: 'notebook:run-cell',\n            keys: ['Accel Enter'],\n            selector: '.jp-Notebook.jp-mod-editMode'\n        });\n    }\n};\n/**\n * A plugin to enable scrolling for outputs by default.\n * Mimic the logic from the classic notebook, as found here:\n * https://github.com/jupyter/notebook/blob/a9a31c096eeffe1bff4e9164c6a0442e0e13cdb3/notebook/static/notebook/js/outputarea.js#L96-L120\n */\nconst scrollOutput = {\n    id: '@retrolab/notebook-extension:scroll-output',\n    autoStart: true,\n    requires: [INotebookTracker],\n    optional: [ISettingRegistry],\n    activate: async (app, tracker, settingRegistry) => {\n        const autoScrollThreshold = 100;\n        let autoScrollOutputs = true;\n        // decide whether to scroll the output of the cell based on some heuristics\n        const autoScroll = (cell) => {\n            if (!autoScrollOutputs) {\n                // bail if disabled via the settings\n                return;\n            }\n            const { outputArea } = cell;\n            // respect cells with an explicit scrolled state\n            const scrolled = cell.model.metadata.get('scrolled');\n            if (scrolled !== undefined) {\n                return;\n            }\n            const { node } = outputArea;\n            const height = node.scrollHeight;\n            const fontSize = parseFloat(node.style.fontSize.replace('px', ''));\n            const lineHeight = (fontSize || 14) * 1.3;\n            // do not set via cell.outputScrolled = true, as this would\n            // otherwise synchronize the scrolled state to the notebook metadata\n            const scroll = height > lineHeight * autoScrollThreshold;\n            cell.toggleClass(SCROLLED_OUTPUTS_CLASS, scroll);\n        };\n        tracker.widgetAdded.connect((sender, notebook) => {\n            var _a;\n            (_a = notebook.model) === null || _a === void 0 ? void 0 : _a.cells.changed.connect((sender, changed) => {\n                // process new cells only\n                if (!(changed.type === 'add')) {\n                    return;\n                }\n                const [cellModel] = changed.newValues;\n                notebook.content.widgets.forEach(cell => {\n                    if (cell.model.id === cellModel.id && cell.model.type === 'code') {\n                        const codeCell = cell;\n                        codeCell.outputArea.model.changed.connect(() => autoScroll(codeCell));\n                    }\n                });\n            });\n            // when the notebook widget is created, process all the cells\n            // TODO: investigate why notebook.content.fullyRendered is not enough\n            notebook.sessionContext.ready.then(() => {\n                notebook.content.widgets.forEach(cell => {\n                    if (cell.model.type === 'code') {\n                        autoScroll(cell);\n                    }\n                });\n            });\n        });\n        if (settingRegistry) {\n            const loadSettings = settingRegistry.load(scrollOutput.id);\n            const updateSettings = (settings) => {\n                autoScrollOutputs = settings.get('autoScrollOutputs')\n                    .composite;\n            };\n            Promise.all([loadSettings, app.restored])\n                .then(([settings]) => {\n                updateSettings(settings);\n                settings.changed.connect(settings => {\n                    updateSettings(settings);\n                });\n            })\n                .catch((reason) => {\n                console.error(reason.message);\n            });\n        }\n    }\n};\n/**\n * Export the plugins as default.\n */\nconst plugins = [\n    checkpoints,\n    kernelLogo,\n    kernelStatus,\n    menuPlugin,\n    runShortcut,\n    scrollOutput\n];\nexport default plugins;\n"],"names":["KERNEL_STATUS_ERROR_CLASS","KERNEL_STATUS_WARN_CLASS","KERNEL_STATUS_INFO_CLASS","KERNEL_STATUS_FADE_OUT_CLASS","checkpoints","id","autoStart","requires","IDocumentManager","ITranslator","optional","IRetroShell","activate","app","docManager","translator","retroShell","shell","trans","load","widget","Widget","DOMUtils","addClass","add","rank","onChange","async","current","currentWidget","context","contextForWidget","fileChanged","disconnect","connect","listCheckpoints","checkpoint","length","node","textContent","__","Time","Date","last_modified","currentChanged","Poll","auto","factory","frequency","interval","backoff","standby","kernelLogo","serviceManager","_a","_b","_c","_d","_e","dispose","parent","NotebookPanel","sessionContext","ready","kernelChanged","name","session","kernel","spec","kernelspecs","specs","kernelIconUrl","resources","document","createElement","img","src","title","display_name","appendChild","started","then","kernelStatus","onStatusChanged","status","kernelDisplayStatus","text","Text","removeClass","statusChanged","menuPlugin","IMainMenu","mainMenu","commands","cellTypeSubmenu","Menu","label","_p","forEach","command","addItem","runMenu","type","submenu","scrollOutput","INotebookTracker","ISettingRegistry","tracker","settingRegistry","autoScrollOutputs","autoScroll","cell","outputArea","undefined","model","metadata","get","scroll","scrollHeight","parseFloat","style","fontSize","replace","toggleClass","widgetAdded","sender","notebook","cells","changed","cellModel","newValues","content","widgets","codeCell","loadSettings","updateSettings","settings","composite","Promise","all","restored","catch","reason","console","error","message","addKeyBinding","keys","selector"],"sourceRoot":""}